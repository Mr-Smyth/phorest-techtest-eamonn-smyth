<!-- ====== INCLUDE HEAD ====== -->
<%- include('./includes/head.ejs') %>
</head>

<!-- Align footer using flex -->
<body class="d-flex flex-column min-vh-100">

    <!-- ====== INCLUDE NAVIGATION BAR ====== -->
    <%- include('./includes/navigation.ejs') %>
    
    <!-- ====== SEARCH RESULTS ====== -->
    <!-- for case - where no client data or incorrect search input -->
    <% if (clients != 'none') {%>
    <div class="jumbotron search__jumbotron col-12 col-md-10">
        <h2 class="main__heading">Select a client to create a voucher</h2>

        <% if (!clients.length > 0) { %>
            <div class="list-group">
                <a href="#phone" class="search-result flex-column align-items-start">
                    <div class="d-flex w-100 justify-content-between">
                        <% if (search === null) { %>
                            <h5 class="m-auto">Sorry but what you entered was incorrect. Click to search again</h5>
                        <% } else { %> 
                            <h5 class="m-auto text-break">Sorry we found no results for <strong><em>'<%= search.split('=')[1] %>'</em></strong>. Click to search again</h5>
                        <% } %>
                    </div>
                </a>
            </div>
        <% } else { %>

            <!-- for case where results were found, we will display them in a list of links -->
            <% clients.forEach(client => { %>
                <div class="list-group">
                    <!-- i want to pass original search method back to vouchers -->
                    <a href="/add-voucher/<%= client.clientId %>" class="search-result flex-column align-items-start">
                        <div class="d-flex w-100 justify-content-between">
                            <h4 class="mb-1"><%= client.firstName %> <%= client.lastName %> <%= client.clientId %></h4>
                        </div>
                        <hr>
                        <p><strong>Phone Number: </strong><%= client.mobile? client.mobile: 'No number provided' %></p>
                        <p class="d-none d-md-block"><strong>Email: </strong><%= client.email? client.email: 'No email provided' %></p>
                        <p><strong>Member since: </strong><%= client.clientSince.split('T')[0] %></p>
                    </a>
                </div>
            <% }) %>
        <% } %>

    </div>
    <% } %>

    <!-- ====== MAIN CONTENT ======  -->
    <!-- We reuse this section when results are displayed - heading message changes depending on clients being present -->
    <main id="search" class="container main__container flex-grow-1 mt-5 col-12 col-md-10">
        <!-- if not equal to none - then we are on search results page. so we ask to search again -->
        <% if (clients != 'none') { %>
            <h2 class="main__heading">Search again</h2>
        <% } else { %>
            <h2 class="main__heading"><%= pageTitle %></h2>
        <% } %>

        <!-- ====== PHONE NUMBER SEARCH FORM ====== -->
        <div class="container text-center">
            <form class="form-inline row no-gutters" action="/client-search" method="POST">
                <div class="col-12 col-md-6 ml-auto  form-group mb-2">
                    <label for="phone" class="sr-only">Enter Phone Number</label>
                    <input type="number" class="form-control col-12 col-md-10" name="phone" id="phone" placeholder="Enter a Phone Number" required >
                </div>
                <button type="submit" class="btn search-button col-12 col-md-4 mr-auto mb-2">Search By Phone Number</button>
            </form>
        </div>

        <!-- ====== EMAIL SEARCH FORM ====== -->
        <div class="container text-center mt-5">
            <form class="form-inline row no-gutters" action="/client-search" method="POST">
                <div class="col-12 col-md-6 ml-auto  form-group mb-2">
                    <label for="email" class="sr-only">Enter Email Address</label>
                    <input type="text" class="form-control col-12 col-md-10" name="email" id="email" placeholder="Enter an email address" required >
                </div>
                <button type="submit" class="btn search-button col-12 col-md-4 mr-auto mb-2">Search By Email</button>
            </form>
        </div>
    </main>

<!-- ====== INCLUDE FOOTER ====== -->
<%- include('./includes/end.ejs') %>